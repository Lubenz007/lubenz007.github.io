<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Getting licenses assigned to user accounts" />
<meta property="og:locale" content="en" />
<meta name="description" content="Create a report of licenses assigned to Azure AD user accounts using the Microsoft Graph API This is a rewrite from here practical365.com My misson was to rewrite the script to use the Microsoft Graph API instead of the MgGraph PowerShell module." />
<meta property="og:description" content="Create a report of licenses assigned to Azure AD user accounts using the Microsoft Graph API This is a rewrite from here practical365.com My misson was to rewrite the script to use the Microsoft Graph API instead of the MgGraph PowerShell module." />
<link rel="canonical" href="https://lubenz007.github.io//posts/license-report/" />
<meta property="og:url" content="https://lubenz007.github.io//posts/license-report/" />
<meta property="og:site_name" content="BensiEgils" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-04-01T00:27:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Getting licenses assigned to user accounts" />
<meta name="twitter:site" content="@lubenz007" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-04-01T00:27:00+00:00","datePublished":"2023-04-01T00:27:00+00:00","description":"Create a report of licenses assigned to Azure AD user accounts using the Microsoft Graph API This is a rewrite from here practical365.com My misson was to rewrite the script to use the Microsoft Graph API instead of the MgGraph PowerShell module.","headline":"Getting licenses assigned to user accounts","mainEntityOfPage":{"@type":"WebPage","@id":"https://lubenz007.github.io//posts/license-report/"},"url":"https://lubenz007.github.io//posts/license-report/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Getting licenses assigned to user accounts | BensiEgils
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="icon" type="image/png" href="/assets/img/favicons/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/svg+xml" href="/assets/img/favicons/favicon.svg">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">



  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.36.4/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.18/dayjs.min.js,npm/dayjs@1.11.18/locale/en.js,npm/dayjs@1.11.18/plugin/relativeTime.js,npm/dayjs@1.11.18/plugin/localizedFormat.js,npm/tocbot@4.36.4/dist/tocbot.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="https://bensiegils.com/assets/img/logo/BensiLogo.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">BensiEgils</a>
    <p class="site-subtitle fst-italic mb-0">Documenting my journey</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tag"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    

      
        <a
          href="https://github.com/lubenz007"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    

      
        <a
          href="https://twitter.com/lubenz007"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-twitter"></i>
        </a>
      
    

      
        <a
          href="javascript:location.href = 'mailto:' + ['bensi','alit.is'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
          
      

      
        <a
          href="https://www.linkedin.com/in/benedikt-gabrÃ­el-egilsson-b7295684"
          aria-label="linkedin"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-linkedin"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Getting licenses assigned to user accounts</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->





<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>Getting licenses assigned to user accounts</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1680308820"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Apr  1, 2023
</time>

      </span>

      <!-- lastmod date -->
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://twitter.com/lubenz007">Benedikt Gabriel Egilsson</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="612 words"
>
  <em>3 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">Getting licenses assigned to user accounts</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">Getting licenses assigned to user accounts</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <h2 id="create-a-report-of-licenses-assigned-to-azure-ad-user-accounts-using-the-microsoft-graph-api"><span class="me-2">Create a report of licenses assigned to Azure AD user accounts using the Microsoft Graph API</span><a href="#create-a-report-of-licenses-assigned-to-azure-ad-user-accounts-using-the-microsoft-graph-api" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<h3 id="this-is-a-rewrite-from-here-practical365com"><span class="me-2">This is a rewrite from <a href="https://practical365.com/create-licensing-report-microsoft365-tenant/">here</a> practical365.com</span><a href="#this-is-a-rewrite-from-here-practical365com" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<blockquote class="prompt-info">
  <p>My misson was to rewrite the script to use the Microsoft Graph API instead of the MgGraph PowerShell module.</p>
</blockquote>

<div class="language-powershell highlighter-rouge"><div class="code-header">
        <span data-label-text="Powershell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
</pre></td><td class="rouge-code"><pre><span class="w">
</span><span class="nv">$ClientID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">''</span><span class="w">
</span><span class="nv">$ClientSecret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">''</span><span class="w">
</span><span class="nv">$tenant_Id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">''</span><span class="w">

</span><span class="c"># Connect to Graph #</span><span class="w">

</span><span class="nv">$Body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w">    
    </span><span class="nx">Grant_Type</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s2">"client_credentials"</span><span class="w">
    </span><span class="nx">resource</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">"https://graph.microsoft.com"</span><span class="w">
    </span><span class="nx">client_id</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="nv">$clientId</span><span class="w">
    </span><span class="nx">client_secret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$clientSecret</span><span class="w">
</span><span class="p">}</span><span class="w"> 
  
</span><span class="nv">$ConnectGraph</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Invoke-RestMethod</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="s2">"https://login.microsoft.com/</span><span class="nv">$tenant_Id</span><span class="s2">/oauth2/token?api-version=1.0"</span><span class="w"> </span><span class="nt">-Method</span><span class="w"> </span><span class="nx">POST</span><span class="w"> </span><span class="nt">-Body</span><span class="w"> </span><span class="nv">$Body</span><span class="w">

</span><span class="c"># Variable Collections #</span><span class="w">

</span><span class="nv">$CSVOutputFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"c:\temp\Microsoft365LicensesReport.CSV"</span><span class="w">
</span><span class="nv">$today</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get-Date</span><span class="w">

</span><span class="nv">$Headers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w">
    </span><span class="s1">'Content-Type'</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">"application/json"</span><span class="w">
    </span><span class="s1">'Authorization'</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Bearer </span><span class="si">$(</span><span class="nv">$ConnectGraph</span><span class="o">.</span><span class="nf">access_token</span><span class="si">)</span><span class="s2">"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="nv">$token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$ConnectGraph</span><span class="o">.</span><span class="nf">access_token</span><span class="w">

</span><span class="c"># Force TLS 1.2.</span><span class="w">
</span><span class="p">[</span><span class="n">Net.ServicePointManager</span><span class="p">]::</span><span class="n">SecurityProtocol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">Net.SecurityProtocolType</span><span class="p">]::</span><span class="n">Tls12</span><span class="w">

</span><span class="kr">function</span><span class="w"> </span><span class="nf">Get-GraphData</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="kr">param</span><span class="w"> </span><span class="p">(</span><span class="w">
        </span><span class="p">[</span><span class="n">parameter</span><span class="p">(</span><span class="n">Mandatory</span><span class="p">)]</span><span class="w">
        </span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nv">$AccessToken</span><span class="p">,</span><span class="w">
      
        </span><span class="p">[</span><span class="n">parameter</span><span class="p">(</span><span class="n">Mandatory</span><span class="p">)]</span><span class="w">
        </span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nv">$Uri</span><span class="w">
    </span><span class="p">)</span><span class="w">

    </span><span class="nv">$Headers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w">
        </span><span class="s1">'Authorization'</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Bearer </span><span class="nv">$AccessToken</span><span class="s2">"</span><span class="w">
    </span><span class="p">}</span><span class="w">

    </span><span class="kr">do</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nv">$Results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Invoke-RestMethod</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="nv">$Uri</span><span class="w"> </span><span class="nt">-Headers</span><span class="w"> </span><span class="nv">$Headers</span><span class="w"> </span><span class="nt">-ErrorAction</span><span class="w"> </span><span class="nx">Stop</span><span class="w">

        </span><span class="nv">$QueryResults</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nv">$Results</span><span class="o">.</span><span class="nf">value</span><span class="w">

        </span><span class="nv">$Uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$Results</span><span class="o">.</span><span class="s1">'@odata.nextLink'</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="kr">while</span><span class="w"> </span><span class="p">(</span><span class="nv">$Uri</span><span class="p">)</span><span class="w">

    </span><span class="kr">return</span><span class="w"> </span><span class="nv">$QueryResults</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c">#This request get SecureScore</span><span class="w">

</span><span class="p">[</span><span class="n">array</span><span class="p">]</span><span class="nv">$Skus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get-GraphData</span><span class="w"> </span><span class="nt">-AccessToken</span><span class="w"> </span><span class="nv">$Token</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="s2">"https://graph.microsoft.com/beta/subscribedSkus"</span><span class="w">
</span><span class="c">#[Array]$Skus = Get-MgSubscribedSku</span><span class="w">

</span><span class="c"># Generate CSV of all product SKUs used in tenant</span><span class="w">
</span><span class="p">[</span><span class="n">array</span><span class="p">]</span><span class="nv">$Sku</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$Skus</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Select-Object</span><span class="w"> </span><span class="nx">SkuId</span><span class="p">,</span><span class="w"> </span><span class="nx">SkuPartNumber</span><span class="w">
</span><span class="c"># Generate list of all service plans used in SKUs in tenant</span><span class="w">
</span><span class="nv">$SPData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">System.Collections.Generic.List</span><span class="p">[</span><span class="n">Object</span><span class="p">]]::</span><span class="n">new</span><span class="p">()</span><span class="w">
</span><span class="kr">ForEach</span><span class="w"> </span><span class="p">(</span><span class="nv">$Sk</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="nv">$Skus</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="kr">ForEach</span><span class="w"> </span><span class="p">(</span><span class="nv">$SP</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="nv">$Sk</span><span class="o">.</span><span class="nf">ServicePlans</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nv">$SPLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">PSCustomObject</span><span class="p">][</span><span class="n">Ordered</span><span class="p">]@{</span><span class="w">  
            </span><span class="nx">ServicePlanId</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="nv">$SP</span><span class="err">.</span><span class="nx">ServicePlanId</span><span class="w">
            </span><span class="nx">ServicePlanName</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="nv">$SP</span><span class="err">.</span><span class="nx">ServicePlanName</span><span class="w">
            </span><span class="nx">ServicePlanDisplayName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$SP</span><span class="err">.</span><span class="nx">ServicePlanName</span><span class="w"> 
        </span><span class="p">}</span><span class="w">
        </span><span class="nv">$SPData</span><span class="o">.</span><span class="nf">Add</span><span class="p">(</span><span class="nv">$SPLine</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="nv">$SkuHashTable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{}</span><span class="w">
</span><span class="kr">ForEach</span><span class="w"> </span><span class="p">(</span><span class="nv">$Line</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="nv">$Sku</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> 
    </span><span class="nv">$SkuHashTable</span><span class="o">.</span><span class="nf">Add</span><span class="p">([</span><span class="n">string</span><span class="p">]</span><span class="nv">$Line</span><span class="o">.</span><span class="nf">SkuId</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nv">$Line</span><span class="o">.</span><span class="nf">skuPartNumber</span><span class="p">)</span><span class="w"> 
</span><span class="p">}</span><span class="w">
</span><span class="nv">$ServicePlanHashTable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{}</span><span class="w">
</span><span class="kr">ForEach</span><span class="w"> </span><span class="p">(</span><span class="nv">$Line2</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="nv">$SPData</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">$ServicePlanHashTable</span><span class="o">.</span><span class="nf">Add</span><span class="p">([</span><span class="n">string</span><span class="p">]</span><span class="nv">$Line2</span><span class="o">.</span><span class="nf">ServicePlanId</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nv">$Line2</span><span class="o">.</span><span class="nf">ServicePlanDisplayName</span><span class="p">)</span><span class="w"> </span><span class="p">}</span><span class="w">

</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span><span class="nv">$Users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get-GraphData</span><span class="w"> </span><span class="nt">-AccessToken</span><span class="w"> </span><span class="nv">$Token</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="s2">"https://graph.microsoft.com/beta/users"</span><span class="w">
</span><span class="nv">$Report</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">System.Collections.Generic.List</span><span class="p">[</span><span class="n">Object</span><span class="p">]]::</span><span class="n">new</span><span class="p">()</span><span class="w">

</span><span class="kr">ForEach</span><span class="w"> </span><span class="p">(</span><span class="nv">$User</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="nv">$users</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="kr">If</span><span class="w"> </span><span class="p">([</span><span class="n">string</span><span class="p">]::</span><span class="n">IsNullOrWhiteSpace</span><span class="p">(</span><span class="nv">$User</span><span class="o">.</span><span class="nf">AssignedLicenses</span><span class="p">)</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="bp">$true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
       </span><span class="c"># Only process account if it has some licenses</span><span class="w">
       </span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"Processing"</span><span class="w"> </span><span class="nv">$User</span><span class="o">.</span><span class="nf">DisplayName</span><span class="w">
       </span><span class="p">[</span><span class="n">array</span><span class="p">]</span><span class="nv">$LicenseInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$Null</span><span class="p">;</span><span class="w"> </span><span class="p">[</span><span class="n">array</span><span class="p">]</span><span class="nv">$DisabledPlans</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$Null</span><span class="w">
       </span><span class="kr">ForEach</span><span class="w"> </span><span class="p">(</span><span class="nv">$License</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="nv">$User</span><span class="o">.</span><span class="nf">AssignedLicenses</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="kr">If</span><span class="w"> </span><span class="p">(</span><span class="nv">$SkuHashTable</span><span class="o">.</span><span class="nf">ContainsKey</span><span class="p">(</span><span class="nv">$License</span><span class="o">.</span><span class="nf">SkuId</span><span class="p">)</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="nv">$True</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
             </span><span class="c"># We found a match in the SKU hash table</span><span class="w">
             </span><span class="nv">$LicenseInfo</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nv">$SkuHashTable</span><span class="o">.</span><span class="nf">Item</span><span class="p">(</span><span class="nv">$License</span><span class="o">.</span><span class="nf">SkuId</span><span class="p">)</span><span class="w"> 
          </span><span class="p">}</span><span class="w">
          </span><span class="kr">Else</span><span class="w"> </span><span class="p">{</span><span class="w">
             </span><span class="c"># Nothing doing, so output the SkuID</span><span class="w">
             </span><span class="nv">$LicenseInfo</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nv">$License</span><span class="w"> 
          </span><span class="p">}</span><span class="w">
          </span><span class="c"># Report any disabled service plans in licenses</span><span class="w">
          </span><span class="kr">If</span><span class="w"> </span><span class="p">([</span><span class="n">string</span><span class="p">]::</span><span class="n">IsNullOrWhiteSpace</span><span class="p">(</span><span class="nv">$License</span><span class="o">.</span><span class="nf">DisabledPlans</span><span class="p">)</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="nv">$False</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
             </span><span class="c"># Check if disabled service plans in a license</span><span class="w">
             </span><span class="kr">ForEach</span><span class="w"> </span><span class="p">(</span><span class="nv">$DisabledPlan</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="nv">$License</span><span class="o">.</span><span class="nf">DisabledPlans</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="c"># Try and find what service plan is disabled</span><span class="w">
                </span><span class="kr">If</span><span class="w"> </span><span class="p">(</span><span class="nv">$ServicePlanHashTable</span><span class="o">.</span><span class="nf">ContainsKey</span><span class="p">(</span><span class="nv">$DisabledPlan</span><span class="p">)</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="nv">$True</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
                   </span><span class="c"># We found a match in the Service Plans hash table</span><span class="w">
                   </span><span class="nv">$DisabledPlans</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nv">$ServicePlanHashTable</span><span class="o">.</span><span class="nf">Item</span><span class="p">(</span><span class="nv">$DisabledPlan</span><span class="p">)</span><span class="w"> 
                </span><span class="p">}</span><span class="w">
                </span><span class="kr">Else</span><span class="w"> </span><span class="p">{</span><span class="w">
                   </span><span class="c"># Nothing doing, so output the Service Plan ID</span><span class="w">
                   </span><span class="nv">$DisabledPlans</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nv">$DisabledPlan</span><span class="w"> 
                </span><span class="p">}</span><span class="w">
             </span><span class="p">}</span><span class="w"> </span><span class="c"># End ForEach disabled plans</span><span class="w">
          </span><span class="p">}</span><span class="w"> </span><span class="c"># End if check for disabled plans  </span><span class="w">
       </span><span class="p">}</span><span class="w"> </span><span class="c"># End Foreach Licenses</span><span class="w">
       </span><span class="c"># Report information</span><span class="w">
       </span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nv">$DisabledPlans</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$DisabledPlans</span><span class="w"> </span><span class="o">-join</span><span class="w"> </span><span class="s2">", "</span><span class="w">
       </span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nv">$LicenseInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$LicenseInfo</span><span class="w"> </span><span class="o">-join</span><span class="w"> </span><span class="p">(</span><span class="s2">", "</span><span class="p">)</span><span class="w">
       </span><span class="nv">$ReportLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">PSCustomObject</span><span class="p">][</span><span class="n">Ordered</span><span class="p">]@{</span><span class="w">  
          </span><span class="nx">User</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="nv">$User</span><span class="err">.</span><span class="nx">DisplayName</span><span class="w">
          </span><span class="nx">UPN</span><span class="w">              </span><span class="o">=</span><span class="w"> </span><span class="nv">$User</span><span class="err">.</span><span class="nx">UserPrincipalName</span><span class="w">
          </span><span class="nx">Country</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="nv">$User</span><span class="err">.</span><span class="nx">Country</span><span class="w">
          </span><span class="nx">Department</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="nv">$User</span><span class="err">.</span><span class="nx">Department</span><span class="w">
          </span><span class="nx">Title</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="nv">$User</span><span class="err">.</span><span class="nx">JobTitle</span><span class="w">
          </span><span class="nx">Licenses</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="nv">$LicenseInfo</span><span class="w">
          </span><span class="s2">"Disabled Plans"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$DisabledPlans</span><span class="w"> 
       </span><span class="p">}</span><span class="w">
       </span><span class="n">Write-Host</span><span class="w"> </span><span class="nv">$ReportLine</span><span class="w">
       </span><span class="nv">$Report</span><span class="o">.</span><span class="nf">Add</span><span class="p">(</span><span class="nv">$ReportLine</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="c">#end If account is licensed</span><span class="w">
    </span><span class="kr">Else</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">$UnlicensedAccounts</span><span class="o">++</span><span class="w"> </span><span class="p">}</span><span class="w">
 </span><span class="p">}</span><span class="w"> </span><span class="c"># End ForEach Users</span><span class="w">
 </span><span class="nv">$Report</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Export-CSV</span><span class="w"> </span><span class="nt">-NoTypeInformation</span><span class="w"> </span><span class="nv">$CSVOutputFile</span><span class="w">


</span></pre></td></tr></tbody></table></code></div></div>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/msgraph/">MSGraph</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/azure/"
            class="post-tag no-text-decoration"
          >azure</a>
        
          <a
            href="/tags/msgraph/"
            class="post-tag no-text-decoration"
          >msgraph</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Getting%20licenses%20assigned%20to%20user%20accounts%20-%20BensiEgils&url=https%3A%2F%2Flubenz007.github.io%2F%2Fposts%2Flicense-report%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fab fa-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=Getting%20licenses%20assigned%20to%20user%20accounts%20-%20BensiEgils&u=https%3A%2F%2Flubenz007.github.io%2F%2Fposts%2Flicense-report%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/sharepoint-to-azurefilez/">Copy sharepoint data to Azure Filez</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/ssh-arc-wac/">Secure Remote Management with Windows Admin Center via Azure Arc and SSH Tunneling.</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Move-VmWare-Azure/">Migrating from VMware to Azure using Azure Files</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/OutofDiskspace-Teams/">Arc - Diskspace Monitoring - Teams)</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/AzureArc-ssh/">Azure Arc - (Azure Cli - ssh - rdp)</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/azure/">azure</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/msgraph/">msgraph</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/usage/">usage</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/hyperv/">hyperv</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/monitor/">monitor</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/powershell/">powershell</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/terraform/">terraform</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/tools/">tools</a>
      
    </div>
  </section>


            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/old-guest-accounts/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1682550049"
  data-df="ll"
  
>
  Apr 26, 2023
</time>

              <h4 class="pt-0 my-2">Getting old guest accounts in Azure AD</h4>
              <div class="text-muted">
                <p>This is a rewrite from here office365itpros.com I have added some more properties to the report. And use msgraph instead of mggraph.  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 ...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/apps-exp/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1680863640"
  data-df="ll"
  
>
  Apr  7, 2023
</time>

              <h4 class="pt-0 my-2">Apps Expiration Azure AD</h4>
              <div class="text-muted">
                <p>This script will check all registered apps in Azure AD and will return the following information: expiring apps, expired apps, and apps with no expiration date.  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/SGraph-securescore/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1679784540"
  data-df="ll"
  
>
  Mar 25, 2023
</time>

              <h4 class="pt-0 my-2">MS Graph API - Get Secure Score for tenant</h4>
              <div class="text-muted">
                <p>Secure Score for O365 Tenant Getting the secure score for a tenant is a bit more complicated than getting the last logon time of a user. You only need to call the following endpoint: https://graph....</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/SGraph-securescore/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>MS Graph API - Get Secure Score for tenant</p>
    </a>
  

  
    <a
      href="/posts/upgrade-hyper/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Upgrade Hyper-V Hosts with Azure Arc</p>
    </a>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>Â©
    <time>2025</time>

    
      <a href="https://twitter.com/lubenz007">Benedikt Gabriel Egilsson</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.4.1"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/azure/">azure</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/msgraph/">msgraph</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/usage/">usage</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/hyperv/">hyperv</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/monitor/">monitor</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/powershell/">powershell</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/terraform/">terraform</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/tools/">tools</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

